#!/bin/bash

# ============================================
# FILE COLLECTOR FOR MARKETING MODULE V2
# Updated: Includes Discover Pages & New Components
# ============================================
#
# Changes from v1:
# - Added: Discover pages (page.tsx, client.tsx, [category])
# - Added: About page
# - Added: New platform-landing components (discover-header, discover-hero, etc)
# - Added: tenant-preview-drawer.tsx
# - UI Components: Only list filenames (auto-generated by shadcn/ui CLI)
#
# Usage:
# chmod +x collect-marketing-module-v2.sh
# ./collect-marketing-module-v2.sh
#
# Run from: /path/to/client (root folder Next.js)
#
# ============================================

# ============================================
# SETUP OUTPUT DIRECTORY & FILE
# ============================================

OUTPUT_DIR="collections"
OUTPUT_FILE="$OUTPUT_DIR/marketing-module-v2-$(date +%Y%m%d-%H%M%S).txt"

# Create collections directory if not exists
if [ ! -d "$OUTPUT_DIR" ]; then
    echo "ğŸ“ Creating collections directory..."
    mkdir -p "$OUTPUT_DIR"
fi

echo "ğŸš€ Marketing Module Collector - V2 (with Discover)"
echo "=============================================="
echo ""
echo "ğŸ“ Working directory: $(pwd)"
echo "ğŸ“ Output directory: $OUTPUT_DIR/"
echo "ğŸ“„ Output file: $OUTPUT_FILE"
echo ""

# Initialize counters
FOUND_COUNT=0
NOT_FOUND_COUNT=0
TOTAL_LINES=0
UI_COUNT=0

# Start file
cat > "$OUTPUT_FILE" << EOF
================================================================
MARKETING MODULE V2 - COMPLETE DEPENDENCIES
Generated on: $(date)
Working Directory: $(pwd)
================================================================

INCLUDES:
- Marketing Pages (home, fitur, cara-kerja, harga, about)
- Discover Pages (discover, discover/[category])
- Platform Landing Components (27 files)
- UI Components (shadcn/ui): Listed by name only
- SEO, Lib, Providers, Config

================================================================

EOF

# ============================================
# FUNCTION: Collect Full File
# ============================================

collect_file() {
    local file=$1
    local relative_path=$2
    
    if [ -f "$file" ]; then
        local line_count=$(wc -l < "$file")
        TOTAL_LINES=$((TOTAL_LINES + line_count))
        FOUND_COUNT=$((FOUND_COUNT + 1))
        echo "âœ… Found: $relative_path (${line_count} lines)"
        cat >> "$OUTPUT_FILE" << EOF

================================================
FILE: $relative_path
Lines: $line_count
================================================

$(cat "$file")

EOF
    else
        NOT_FOUND_COUNT=$((NOT_FOUND_COUNT + 1))
        echo "âŒ NOT FOUND: $relative_path"
        cat >> "$OUTPUT_FILE" << EOF

================================================
FILE: $relative_path
Lines: 0
================================================

âš ï¸ FILE NOT FOUND - Needs to be created!

EOF
    fi
}

# ============================================
# FUNCTION: List UI Component (Name Only)
# ============================================

list_ui_component() {
    local file=$1
    local relative_path=$2
    
    if [ -f "$file" ]; then
        UI_COUNT=$((UI_COUNT + 1))
        echo "ğŸ“¦ Listed: $relative_path (shadcn/ui)"
    else
        echo "âŒ NOT FOUND: $relative_path (shadcn/ui)"
    fi
}

# ============================================
# SECTION 1: MARKETING PAGES (5 files)
# ============================================

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ¯ MARKETING PAGES (5 files)"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

collect_file "src/app/page.tsx" "src/app/page.tsx"
collect_file "src/app/about/page.tsx" "src/app/about/page.tsx"
collect_file "src/app/fitur/page.tsx" "src/app/fitur/page.tsx"
collect_file "src/app/cara-kerja/page.tsx" "src/app/cara-kerja/page.tsx"
collect_file "src/app/harga/page.tsx" "src/app/harga/page.tsx"

# ============================================
# SECTION 2: DISCOVER PAGES (6 files) - NEW!
# ============================================

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ” DISCOVER PAGES (6 files) - NEW!"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

collect_file "src/app/discover/page.tsx" "src/app/discover/page.tsx"
collect_file "src/app/discover/client.tsx" "src/app/discover/client.tsx"
collect_file "src/app/discover/[category]/page.tsx" "src/app/discover/[category]/page.tsx"
collect_file "src/app/discover/[category]/client.tsx" "src/app/discover/[category]/client.tsx"
collect_file "src/app/discover/[category]/not-found.tsx" "src/app/discover/[category]/not-found.tsx"

# ============================================
# SECTION 3: PLATFORM LANDING COMPONENTS (27 files)
# ============================================

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ”´ PLATFORM LANDING COMPONENTS (27 files)"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Index & Layout
collect_file "src/components/platform-landing/index.ts" "src/components/platform-landing/index.ts"

# Header & Footer
collect_file "src/components/platform-landing/landing-header.tsx" "src/components/platform-landing/landing-header.tsx"
collect_file "src/components/platform-landing/landing-footer.tsx" "src/components/platform-landing/landing-footer.tsx"
collect_file "src/components/platform-landing/minimal-footer.tsx" "src/components/platform-landing/minimal-footer.tsx"

# Discover Components (NEW)
echo ""
echo "ğŸ”¥ DISCOVER COMPONENTS (NEW):"
collect_file "src/components/platform-landing/discover-header.tsx" "src/components/platform-landing/discover-header.tsx"
collect_file "src/components/platform-landing/discover-hero.tsx" "src/components/platform-landing/discover-hero.tsx"
collect_file "src/components/platform-landing/category-filter-bar.tsx" "src/components/platform-landing/category-filter-bar.tsx"
collect_file "src/components/platform-landing/tenant-preview-drawer.tsx" "src/components/platform-landing/tenant-preview-drawer.tsx"

# Hero & Intro Sections
echo ""
echo "ğŸ“¦ HERO & INTRO SECTIONS:"
collect_file "src/components/platform-landing/hero-section.tsx" "src/components/platform-landing/hero-section.tsx"
collect_file "src/components/platform-landing/logos-section.tsx" "src/components/platform-landing/logos-section.tsx"
collect_file "src/components/platform-landing/problem-section.tsx" "src/components/platform-landing/problem-section.tsx"
collect_file "src/components/platform-landing/solution-section.tsx" "src/components/platform-landing/solution-section.tsx"
collect_file "src/components/platform-landing/honest-section.tsx" "src/components/platform-landing/honest-section.tsx"
collect_file "src/components/platform-landing/target-user-section.tsx" "src/components/platform-landing/target-user-section.tsx"

# Feature Sections
echo ""
echo "ğŸ“¦ FEATURE SECTIONS:"
collect_file "src/components/platform-landing/how-it-works-section.tsx" "src/components/platform-landing/how-it-works-section.tsx"
collect_file "src/components/platform-landing/features-section.tsx" "src/components/platform-landing/features-section.tsx"
collect_file "src/components/platform-landing/fibidy-ai-section.tsx" "src/components/platform-landing/fibidy-ai-section.tsx"
collect_file "src/components/platform-landing/categories-section.tsx" "src/components/platform-landing/categories-section.tsx"

# Testimonials
echo ""
echo "ğŸ“¦ TESTIMONIAL SECTIONS:"
collect_file "src/components/platform-landing/testimonial-highlight-section.tsx" "src/components/platform-landing/testimonial-highlight-section.tsx"
collect_file "src/components/platform-landing/testimonials-section.tsx" "src/components/platform-landing/testimonials-section.tsx"
collect_file "src/components/platform-landing/lazy-testimonials.tsx" "src/components/platform-landing/lazy-testimonials.tsx"

# Pricing & CTA
echo ""
echo "ğŸ“¦ PRICING & CTA:"
collect_file "src/components/platform-landing/pricing-section.tsx" "src/components/platform-landing/pricing-section.tsx"
collect_file "src/components/platform-landing/faq-section.tsx" "src/components/platform-landing/faq-section.tsx"
collect_file "src/components/platform-landing/cta-section.tsx" "src/components/platform-landing/cta-section.tsx"

# UMKM Showcase
echo ""
echo "ğŸ“¦ UMKM SHOWCASE:"
collect_file "src/components/platform-landing/umkm-discover-section.tsx" "src/components/platform-landing/umkm-discover-section.tsx"
collect_file "src/components/platform-landing/umkm-showcase-section.tsx" "src/components/platform-landing/umkm-showcase-section.tsx"

# Blog (if exists)
echo ""
echo "ğŸ“¦ BLOG (Optional):"
collect_file "src/components/platform-landing/blog-section.tsx" "src/components/platform-landing/blog-section.tsx"

# ============================================
# SECTION 4: UI COMPONENTS (shadcn/ui)
# âœ… LIST ONLY - No Full Content
# ============================================

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸŸ  UI COMPONENTS - shadcn/ui (20 files)"
echo "   â„¹ï¸  Auto-generated by CLI - Listed only"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

cat >> "$OUTPUT_FILE" << EOF

================================================
UI COMPONENTS (shadcn/ui) - Auto-generated
================================================

These components are auto-generated by shadcn/ui CLI.
No need to include full content - just verify they exist.

Required UI Components:

EOF

# Core UI
list_ui_component "src/components/ui/button.tsx" "src/components/ui/button.tsx"
list_ui_component "src/components/ui/badge.tsx" "src/components/ui/badge.tsx"
list_ui_component "src/components/ui/card.tsx" "src/components/ui/card.tsx"
list_ui_component "src/components/ui/avatar.tsx" "src/components/ui/avatar.tsx"
list_ui_component "src/components/ui/input.tsx" "src/components/ui/input.tsx"
list_ui_component "src/components/ui/skeleton.tsx" "src/components/ui/skeleton.tsx"

# Navigation
list_ui_component "src/components/ui/accordion.tsx" "src/components/ui/accordion.tsx"
list_ui_component "src/components/ui/sheet.tsx" "src/components/ui/sheet.tsx"
list_ui_component "src/components/ui/navigation-menu.tsx" "src/components/ui/navigation-menu.tsx"
list_ui_component "src/components/ui/dropdown-menu.tsx" "src/components/ui/dropdown-menu.tsx"
list_ui_component "src/components/ui/tabs.tsx" "src/components/ui/tabs.tsx"

# Drawer (for tenant preview)
list_ui_component "src/components/ui/drawer.tsx" "src/components/ui/drawer.tsx"
list_ui_component "src/components/ui/dialog.tsx" "src/components/ui/dialog.tsx"
list_ui_component "src/components/ui/scroll-area.tsx" "src/components/ui/scroll-area.tsx"

# Decorative
list_ui_component "src/components/ui/dot-pattern.tsx" "src/components/ui/dot-pattern.tsx"
list_ui_component "src/components/ui/word-rotate.tsx" "src/components/ui/word-rotate.tsx"
list_ui_component "src/components/ui/bento-grid.tsx" "src/components/ui/bento-grid.tsx"
list_ui_component "src/components/ui/highlighter.tsx" "src/components/ui/highlighter.tsx"
list_ui_component "src/components/ui/interactive-hover-button.tsx" "src/components/ui/interactive-hover-button.tsx"
list_ui_component "src/components/ui/marquee.tsx" "src/components/ui/marquee.tsx"

# Notification
list_ui_component "src/components/ui/sonner.tsx" "src/components/ui/sonner.tsx"

# Write UI component list to output
cat >> "$OUTPUT_FILE" << EOF
1. âœ… button.tsx
2. âœ… badge.tsx
3. âœ… card.tsx
4. âœ… avatar.tsx
5. âœ… input.tsx
6. âœ… skeleton.tsx
7. âœ… accordion.tsx
8. âœ… sheet.tsx
9. âœ… navigation-menu.tsx
10. âœ… dropdown-menu.tsx
11. âœ… tabs.tsx
12. âœ… drawer.tsx
13. âœ… dialog.tsx
14. âœ… scroll-area.tsx
15. âœ… dot-pattern.tsx
16. âœ… word-rotate.tsx
17. âœ… bento-grid.tsx
18. âœ… highlighter.tsx
19. âœ… interactive-hover-button.tsx
20. âœ… marquee.tsx
21. âœ… sonner.tsx

Note: All UI components are auto-generated via:
  npx shadcn@latest add [component-name]

If any component is missing, regenerate with CLI.

================================================

EOF

# ============================================
# SECTION 5: SEO COMPONENTS
# ============================================

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ” SEO COMPONENTS (2 files)"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

collect_file "src/components/seo/index.ts" "src/components/seo/index.ts"
collect_file "src/components/seo/organization-schema.tsx" "src/components/seo/organization-schema.tsx"

# ============================================
# SECTION 6: LIB UTILITIES
# ============================================

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸŸ¡ LIB UTILITIES (6 files)"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

collect_file "src/lib/cn.ts" "src/lib/cn.ts"
collect_file "src/lib/utils.ts" "src/lib/utils.ts"
collect_file "src/lib/format.ts" "src/lib/format.ts"
collect_file "src/lib/validations.ts" "src/lib/validations.ts"
collect_file "src/lib/seo.ts" "src/lib/seo.ts"
collect_file "src/lib/store-url.ts" "src/lib/store-url.ts"

# ============================================
# SECTION 7: STYLES & LAYOUT
# ============================================

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ¨ STYLES & LAYOUT (2 files)"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

collect_file "src/app/globals.css" "src/app/globals.css"
collect_file "src/app/layout.tsx" "src/app/layout.tsx"

# ============================================
# SECTION 8: PROVIDERS
# ============================================

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ”Œ PROVIDERS (4 files)"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

collect_file "src/providers/index.tsx" "src/providers/index.tsx"
collect_file "src/providers/theme-provider.tsx" "src/providers/theme-provider.tsx"
collect_file "src/providers/hydration-provider.tsx" "src/providers/hydration-provider.tsx"
collect_file "src/providers/toast-provider.tsx" "src/providers/toast-provider.tsx"

# ============================================
# SECTION 9: CONFIG
# ============================================

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "âš™ï¸ CONFIG (5 files)"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

collect_file "src/config/site.ts" "src/config/site.ts"
collect_file "src/config/constants.ts" "src/config/constants.ts"
collect_file "src/config/categories.ts" "src/config/categories.ts"
collect_file "src/config/seo.config.ts" "src/config/seo.config.ts"
collect_file "src/config/navigation.ts" "src/config/navigation.ts"

# ============================================
# SUMMARY
# ============================================

TOTAL_COLLECTED=$((FOUND_COUNT + NOT_FOUND_COUNT))
TOTAL_FILES=$((TOTAL_COLLECTED + UI_COUNT))

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ğŸ“Š COLLECTION SUMMARY"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

cat >> "$OUTPUT_FILE" << EOF

================================================================
COLLECTION SUMMARY
================================================================

ğŸ“¦ Custom Components (Full Content):
   âœ… Found: $FOUND_COUNT files
   âŒ Missing: $NOT_FOUND_COUNT files
   ğŸ“ Total lines: $TOTAL_LINES

ğŸŸ  UI Components (shadcn/ui - Listed Only):
   ğŸ“‹ Total: $UI_COUNT files
   â„¹ï¸  Auto-generated by CLI

ğŸ“Š Grand Total:
   ğŸ¯ Marketing Pages: 5
   ğŸ” Discover Pages: 5 (NEW)
   ğŸ”´ Platform Landing: 27
   ğŸŸ  UI Components: 21 (listed only)
   ğŸ” SEO: 2
   ğŸŸ¡ Lib: 6
   ğŸ¨ Styles: 2
   ğŸ”Œ Providers: 4
   âš™ï¸ Config: 5
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ğŸ“ Total Files: $TOTAL_FILES

ğŸ‰ Collection Method:
   - Custom code: Full content collected
   - shadcn/ui: Names listed only (auto-generated)
   - File size optimized for readability

ğŸ“ Output Location:
   $(pwd)/$OUTPUT_FILE

================================================================
END OF COLLECTION
================================================================
EOF

echo ""
echo "âœ… Collection complete!"
echo ""
echo "ğŸ“ Output directory: $OUTPUT_DIR/"
echo "ğŸ“„ Output file: $OUTPUT_FILE"
echo "ğŸ“Š File size: $(du -h "$OUTPUT_FILE" 2>/dev/null | cut -f1 || echo "N/A")"
echo ""
echo "ğŸ“‹ Summary:"
echo "   âœ… Custom files found: $FOUND_COUNT"
echo "   âŒ Missing: $NOT_FOUND_COUNT"
echo "   ğŸ“¦ UI components: $UI_COUNT (listed only)"
echo "   ğŸ“ Total lines collected: $TOTAL_LINES"
echo "   ğŸ“ Total files tracked: $TOTAL_FILES"
echo ""
if [ $NOT_FOUND_COUNT -eq 0 ]; then
    echo "ğŸ‰ All files collected successfully!"
else
    echo "âš ï¸  WARNING: $NOT_FOUND_COUNT file(s) missing - check output file"
fi
echo ""
echo "ğŸ“‚ Navigate to output:"
echo "   cd $OUTPUT_DIR"
echo "   cat $(basename $OUTPUT_FILE)"
echo ""
echo "ğŸ‰ Done!"